# seedData.ts 说明文档

## 作用与设计

`server/src/seedData.ts` 是**种子数据文件**（Seed Data），用于在数据库为空时提供初始数据。

### 设计原则

1. **初始化用途**：只在数据库为空或需要更新时使用
2. **默认数据**：提供系统运行所需的基础数据（默认案例、技巧库）
3. **数据分离**：用户通过管理后台新建的数据**直接保存到数据库**，不会写入 `seedData.ts`

### 工作流程

```
应用启动
  ↓
调用 ensureSeed()
  ↓
检查数据库
  ├─ 案例为空 → 插入默认案例
  ├─ 技巧数量不一致 → 更新技巧库（删除旧数据，插入新数据）
  └─ 已有数据 → 跳过或增量更新
  ↓
应用正常运行
  ↓
用户通过管理后台新建案例/技巧
  ↓
数据直接保存到数据库（不写入 seedData.ts）
```

### 为什么这样设计？

1. **版本控制友好**：`seedData.ts` 是代码的一部分，可以版本控制
2. **部署一致性**：新环境部署时自动获得默认数据
3. **数据管理分离**：
   - 默认数据（seedData.ts）→ 代码管理，版本控制
   - 用户数据（数据库）→ 运行时管理，持久化存储

### 当前行为

- **案例**：只在数据库为空时插入，之后用户新建的案例不会影响 seedData.ts
- **技巧**：检测到数量不一致时会更新（删除旧数据，插入新数据）

### 如果需要同步

如果希望将数据库中的数据同步回 `seedData.ts`（例如备份或版本控制），可以：

1. **手动导出**：从数据库导出数据，手动更新 seedData.ts
2. **添加导出功能**：创建一个管理后台功能，导出当前数据库数据到 seedData.ts 格式

### 建议

- **保留 seedData.ts**：作为默认数据源，便于新环境部署
- **用户数据独立**：用户新建的数据保存在数据库中，通过管理后台管理
- **定期备份**：定期备份数据库，而不是依赖 seedData.ts
